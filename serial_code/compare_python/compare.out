Initializing MultiHeadAttention
Loading weights from the npz file
Wq shape: 128 x 128
Wk shape: 128 x 128
Wv shape: 128 x 128
Wo shape: 128 x 128
Checking data pointers and types
First few elements of Wq: 0.0698438 0.0476354 0.0960122 -0.00538993 -0.0835432 
Converting weights to Eigen matrices
Weights loaded successfully
Loading input matrix x from the npy file
Input x shape: 2 x 128
Starting computation
Output:
   0.240616   0.0270687   -0.376149    0.438459   -0.475206 -0.00522469   -0.101441   -0.295716    0.138547    0.199437    0.315706     0.15887  -0.0758279    0.479985    0.259995   -0.324046   -0.205868    -0.23979   -0.159522   -0.231602   -0.311786   -0.252765   -0.206566  -0.0927601   0.0224061   0.0973151     0.24983  -0.0395948   0.0396358   0.0610656  -0.0725959   -0.178985 -0.00677603   -0.291052    0.456749   -0.121978    0.342943   0.0963332   -0.139786   -0.164022   -0.180231     0.25794    0.333635    0.242366   -0.258205    0.116682  -0.0935939   0.0595126    0.207516   -0.186188   0.0532283  -0.0934102   0.0778749   -0.324394   0.0160054   -0.171688    0.256862   -0.421933    0.256346   0.0327285    -0.11842  -0.0450265     0.15888     0.10083    0.362697    0.293564     0.23927     0.71512    0.263014    0.164603    0.191805  -0.0452293  -0.0496664   -0.209108   -0.210682    0.570319   -0.203161     0.21359   -0.193355    0.190681   -0.117435   -0.164079    0.499911    0.246566   -0.312405    0.248061   0.0845488   0.0236069     0.17299   0.0962451    -0.18822   0.0270241  -0.0315524    0.280135   -0.014895     0.17314 -0.00324352    0.250577   -0.256199    0.327631   -0.231466   -0.111562   -0.261873    0.209835   0.0196902  -0.0306806    0.289717   -0.301385   -0.213379   0.0379275    0.337011  -0.0533732    -0.27591    0.100349    0.347251    0.135898   0.0786207  -0.0297338     0.08594   -0.307225   -0.494035   -0.335835   -0.193886    0.151527  -0.0946955    0.354446    0.139027    0.306298
   0.405227   -0.118051    -0.45146    0.596185   -0.216349  -0.0195981    0.073912   -0.274234    0.113458     0.23613    0.344992   0.0113447   -0.152895    0.279148    0.040752   -0.405353  -0.0649378   -0.311398   -0.290541   -0.259397   -0.415284   -0.373037   -0.146921  -0.0458243   -0.138772   0.0842299    0.375619   -0.344066      0.1989   0.0996287   -0.164273   0.0947166  -0.0577568   -0.448339    0.501493   -0.191135    0.261936   0.0632977   0.0408737   -0.202682   -0.434485    0.238631    0.320137    0.141037   -0.323007    0.248859   -0.140242   0.0762365    0.431261   -0.352821   0.0275174   -0.130858   -0.102139   -0.374998  -0.0547303   0.0452674    0.160702   -0.331824   0.0245491  -0.0871585   -0.140998   0.0229023   0.0679839   0.0630742    0.118893    0.276747    0.221082    0.617181     0.27304    0.012542    0.161759  -0.0892353   -0.051695  -0.0124957   -0.223215    0.545847   -0.239222    0.189806   -0.125199    0.245769   0.0576506  -0.0648389    0.687645     0.38167   -0.285353    0.166379  -0.0124087     0.12991   0.0229704    0.293086   -0.181039    0.270543   -0.064487    0.110872  -0.0379599    0.146952    -0.10542    0.187766   -0.311625    0.412035   -0.286519   -0.202431   -0.276085    0.245353    0.139168  -0.0360087    0.338716   -0.401034   -0.158711   -0.138013    0.176079   0.0472862   -0.193405    0.262779    0.345252   -0.117349  -0.0373879  -0.0590821   0.0799996   -0.208311   -0.435952   -0.222258   -0.025827    0.207689   -0.189583    0.285879   0.0593838    0.369347
Execution time: 0.00181908 seconds
Model dimensions: num_heads = 4, d_model = 128
Matrix dimensions: batch_size = 2
Loading expected output from the npy file
Expected Output:
     0.15312     0.467725     -0.11496     0.452403    -0.899576     0.505099     0.214623     0.112106    0.0729785   -0.0121941     0.423632     0.203367    -0.502349    0.0778018   -0.0527205    -0.160911    -0.366611    -0.552521     0.101611     0.569058     0.219216    0.0461233     -0.31477     0.133167     0.062986    -0.137907     0.201557   -0.0247576   -0.0637896    0.0135593   -0.0825129     0.369283    -0.194676    -0.160618    -0.265596   -0.0638158    -0.249569    -0.531958    -0.159838     0.194749    -0.158217     0.303729     0.664643    -0.487663    0.0595457     0.301802    -0.348091     0.315873    -0.417974     0.595733     0.319346     0.481249     0.116244   -0.0200974     0.270882    -0.187483     0.581262   -0.0592371    -0.226844     0.868996    -0.476464     0.302701    -0.401489    -0.245936     0.672319 5.21733e-321 3.70377e-317    -0.262085      0.50465      1.38974    -0.460786     0.321179     0.454169     0.227393     0.259308    -0.982018     -1.23411    -0.708982     0.327719    -0.972745    -0.271069     0.071979      1.15396    -0.713364     0.144643     -0.22181      -1.1841   -0.0699499   -0.0457503    0.0928171   -0.0497475    0.0907364     0.816082      1.06014    -0.405269     0.908999      -1.0108     -1.18551    -0.896416 1.15889e-310 3.70677e-317    -0.170337    -0.675928     0.946737     0.683157     0.336641    -0.890075    -0.121436     0.171881      1.77974     0.861988     -0.46481    -0.520482     0.157637      -0.3488    0.0409677    -0.790643     -1.26155     0.490988     -1.16457  -0.00306732    -0.154139   -0.0374509   -0.0638465     0.439113     -0.44744     -1.04695    -0.400621
   0.0996966    -0.254074    -0.163231    -0.120326    -0.354619   0.00613274    0.0625743     0.397733     0.224952   -0.0907444     0.251537     0.469329     0.051847    -0.213961    -0.266209     0.195277    -0.176985   -0.0530992    0.0117635    -0.287264    -0.285398       0.1731     0.601002     -0.20896     0.145598    0.0938722     0.156637    -0.244126    -0.133883    -0.448426    -0.498368    -0.492812     0.264558    -0.503171     0.258601  -0.00567298    -0.168687     0.118531     0.279503     -0.59573     0.105395    -0.131571    0.0517643    -0.467321     0.244494     0.305202     0.146607    -0.299342    -0.132906     0.135628     0.439418    0.0106769     0.165736    -0.238178     0.225687    -0.146567    -0.413758    -0.299337     0.330549     0.262481     0.022718    -0.477551    -0.376321  -0.00127391    0.0873141 2.61361e-321 -1.86668e-23    -0.759458    -0.282802    -0.375351     0.436479   -0.0753272    -0.423022     0.145381     0.354594     0.791312    -0.108466     0.550118     0.129102    -0.154378    -0.277116    0.0546004     0.235622      1.54813     0.470797    -0.177591    0.0118597    -0.162107    -0.174913     -1.00559     0.360367   -0.0902416    0.0072657     0.661301    -0.831444      1.07265    -0.375581     -1.21989 7.83094e-321 1.15889e-310 3.70677e-317    -0.305214      1.95121    -0.433434     0.489847    -0.152074     0.195504      0.49152    -0.401648     0.347031    -0.394449      1.22742     0.660856     0.207289     0.422867    -0.441683      0.77849    -0.162223      0.38111     0.738014    -0.136304    -0.556435     0.281473     0.528811     0.367325    0.0233983     0.516979     0.286563
The outputs do not match.